FROM rocker/ml:4.0.5-cuda11.1

RUN apt-get update && apt-get install -y --no-install-recommends \
  cuda-samples-11-1

# install tensorflow 1.15.5
RUN pip install nvidia-pyindex
RUN pip install nvidia-tensorflow[horovod]

# WORKDIR /usr/local/cuda-11.1/samples
# RUN make

COPY nvblas-cuda11.conf /etc/nvblas.conf
COPY nvblas.R /
COPY test-gpu.sh /
RUN chmod +x /test-gpu.sh

ENTRYPOINT ["tail"]
CMD ["-f","/dev/null"]
